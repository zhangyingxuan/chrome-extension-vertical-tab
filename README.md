# Chrome 垂直标签页管理器

一个功能强大的 Chrome 浏览器垂直标签页管理插件，支持域名分组和自定义分组，提供直观的侧边栏界面。

## 功能特性

### 分组管理

- **域名分组模式**：自动按域名对标签页进行智能分组
- **自定义分组模式**：手动创建、编辑、删除自定义分组，支持拖拽分配
- **分组颜色**：为每个自定义分组设置独特的颜色标识
- **分组折叠**：支持展开/折叠分组，节省空间

### 智能排序

- **三种排序模式**：默认排序、域名升序、域名降序
- **智能图标切换**：单个排序图标支持三种状态循环切换
- **拖拽排序优先**：用户通过拖拽进行的排序优先级高于域名排序
- **排序持久化**：排序偏好自动保存到本地存储
- **新标签页自动排序**：新标签页加载完成后自动移动到相同域名标签页旁
- **自定义分组排序**：在自定义分组模式下，有分组的标签页排在最前面，未分组的按域名分组排序

### 标签页操作

- **拖拽分配**：通过拖拽将标签页分配到不同的自定义分组
- **拖拽排序**：支持分组内和未分组标签页的拖拽排序
- **快速切换**：点击标签页快速切换到对应页面
- **关闭标签**：一键关闭不需要的标签页
- **搜索功能**：快速搜索标签页标题和 URL

### 界面特性

- **垂直布局**：侧边栏垂直显示所有标签页，充分利用屏幕空间
- **右键菜单**：支持分组和标签页的右键操作菜单
- **活动状态**：高亮显示当前活动标签页和分组
- **搜索统计**：显示搜索结果统计信息
- **智能切换**：点击插件图标可切换侧边栏的显示与隐藏

## 使用方法

### 安装插件

1. 克隆项目到本地
2. 运行 `pnpm install` 安装依赖
3. 运行 `pnpm build` 构建插件
4. 打开 Chrome 扩展程序页面 (`chrome://extensions/`)
5. 开启"开发者模式"
6. 点击"加载已解压的扩展程序"
7. 选择项目根目录

### 切换分组模式

点击底部工具栏的"切换分组模式"按钮，在域名分组和自定义分组之间切换：

- **域名分组**：自动按域名分组，适合快速浏览和管理
- **自定义分组**：手动创建和管理分组，适合项目分类

### 侧边栏显示控制

点击浏览器工具栏中的插件图标，可以智能切换侧边栏的显示与隐藏：

- **显示侧边栏**：当侧边栏隐藏时，点击图标会显示侧边栏
- **隐藏侧边栏**：当侧边栏显示时，点击图标会隐藏侧边栏
- **状态记忆**：侧边栏的显示状态会自动保存，下次打开时保持上次的状态

### 排序功能使用

#### 排序优先级规则

- **拖拽排序优先**：用户通过拖拽进行的排序优先级最高
- **域名排序**：当用户选择域名排序时，会覆盖拖拽排序
- **默认排序**：当用户选择默认排序时，恢复拖拽排序的显示

#### 操作步骤

1. **切换排序方式**：点击底部工具栏的排序图标进行循环切换
   - **默认排序图标**：显示默认排序状态
   - **升序排序图标**：按域名字母顺序升序排序
   - **降序排序图标**：按域名字母顺序降序排序
2. **自定义分组排序**：排序功能提供智能排序逻辑：
   - **有分组的标签页优先**：所有有分组的标签页排在最前面，按分组 ID 排序
   - **未分组的按域名排序**：未分组的标签页按域名分组，并根据选择的排序模式进行排序
   - **分组内保持相对顺序**：同一分组内的标签页保持原有的相对顺序
   - **域名内按标题排序**：同一域名内的未分组标签页按标题字母顺序排序
3. **拖拽排序**：在分组内或未分组区域拖拽标签页进行排序
4. **自动同步**：排序结果会自动保存到本地存储

### 新标签页自动排序

插件会自动监听新标签页的创建和加载状态：

1. **自动检测**：当新标签页创建时，插件会开始监听其加载状态
2. **域名识别**：标签页加载完成后，插件会提取其域名信息
3. **智能定位**：自动找到相同域名的标签页位置
4. **自动移动**：将新标签页移动到相同域名标签页的旁边

**使用场景示例**：

- 在浏览 GitHub 时打开新的 GitHub 页面，新标签页会自动排列到其他 GitHub 标签页旁
- 在查看文档时打开新的文档页面，相关页面会自动归类到一起
- 新标签页会保持与相关页面的视觉关联，提高浏览效率

### 创建自定义分组

1. 切换到自定义分组模式
2. 右键点击未分组标签页，选择"移动到新分组"
3. 分组会自动创建并分配随机颜色
4. 右键点击分组标题可重命名和修改颜色

### 编辑自定义分组

1. 将鼠标悬停在分组标题上
2. 右键点击分组标题
3. 选择相应操作：
   - **重命名分组**：修改分组名称
   - **修改颜色**：更改分组颜色标识
   - **取消分组**：将分组内标签页移出到未分组
   - **关闭分组**：关闭分组内所有标签页并删除分组

### 分配标签页到分组

1. **拖拽分配**：直接拖拽标签页到目标分组的标题区域或列表区域
2. **右键菜单**：右键点击标签页，选择"移动到新分组"或选择现有分组
3. **移除分组**：使用分组内的"移除"按钮将标签页移出分组

### 搜索标签页

1. 在搜索框中输入关键词
2. 支持按标题和 URL 搜索
3. 显示匹配的分组和标签页数量统计

## 开发指南

### 技术栈

- **前端框架**：Vue 3 + TypeScript
- **构建工具**：Vite
- **样式预处理器**：Less
- **图标库**：TDesign Icons
- **浏览器 API**：Chrome Extension API

### 开发命令

```bash
# 安装依赖
pnpm install

# 开发模式
pnpm dev

# 构建插件
pnpm build

# 监听模式构建
pnpm watch

# 预览构建结果
pnpm preview
```

### 项目结构

```
src/
├── App.vue              # 主应用组件
├── components/          # 组件目录
│   ├── CustomGroupView.vue    # 自定义分组视图
│   ├── DomainGroupView.vue    # 域名分组视图
│   ├── FooterBar.vue         # 底部工具栏
│   ├── ContextMenu.vue       # 右键菜单
│   └── ...
├── utils/              # 工具函数
│   ├── tabManager.ts        # 标签页管理工具
│   ├── colorUtils.ts        # 颜色工具
│   └── index.ts            # 工具函数入口
├── styles/             # 样式文件
│   ├── app.less            # 主样式文件
│   ├── common.less         # 通用样式
│   └── ...
├── type.ts             # TypeScript类型定义
└── config.ts           # 配置常量
```

### 核心功能模块

1. **分组管理**：支持两种分组模式的切换和状态持久化
2. **排序系统**：支持域名排序和默认排序，拖拽排序优先级最高
3. **智能排序**：新标签页自动排序到相同域名旁
4. **拖拽系统**：实现标签页的拖拽分配和排序功能
5. **存储系统**：使用 Chrome Storage API 保存用户偏好
6. **事件监听**：监听 Chrome 标签页和分组的变化事件
7. **搜索功能**：实现高效的标签页搜索和过滤

### 新标签页自动排序实现原理

1. **事件监听**：通过 `chrome.tabs.onCreated` 监听新标签页创建
2. **状态检测**：使用 `chrome.tabs.onUpdated` 监听标签页加载状态
3. **域名提取**：通过 `getDomainOfUrl` 函数提取标签页域名
4. **智能定位**：查找相同域名的标签页位置
5. **自动移动**：使用 `chrome.tabs.move` API 移动标签页到目标位置

## 注意事项

- 插件需要 Chrome 88+版本支持
- 需要授予标签页、分组、存储等权限
- 自定义分组状态会持久化保存
- 排序变更会自动保存到本地存储
- 自定义分组模式下的排序为本地排序，不会影响 Chrome 标签页的实际顺序
- **排序优先级**：拖拽排序 > 域名排序
- **新标签页排序**：仅在域名分组模式下生效，标签页加载完成后自动执行
- **自定义分组排序逻辑**：在自定义分组模式下，排序功能会优先显示有分组的标签页，未分组的标签页按域名分组排序，提供更直观的浏览体验
- **侧边栏切换**：点击插件图标可切换侧边栏显示状态，状态会自动保存到浏览器存储

## 许可证

MIT License
